<template name="projectInfo">
  <!--
    <div class="ui big top attached label">
      {{details.name}}
    </div>
  -->
  {{#if Template.subscriptionsReady}}
    {{>projectDetails details}}
    <div class="ui divider"></div>
    {{> progress}}
  {{else}}
    <div class="ui active centered inline loader"></div>
  {{/if}}
</template>

<template name="projectDetails">
  <div class="ui grid">
    <div class="fluid five wide column">
      <div class="ui segment">
        {{name}}
      </div>
      <div class="ui segment">
        {{> projectComments}}
      </div>
    </div>

    <div class="fluid eleven wide column">
      <div class="ui top attached tabular menu">
        <a class="item active" data-tab="first">Tasks</a>
        <a class="item" data-tab="second">Second</a>
        <a class="item" data-tab="third">Third</a>
      </div>
      <div class="ui bottom attached tab segment active" data-tab="first">
        <table class="ui basic single line striped table">
          <thead>
            <tr>
              <th>Open Task</th>
              <th>Assigned To</th>
              <th>Due Date</th>
            </tr>
          </thead>
          <tbody>
            {{#each tasks}}
              {{> taskDetailCompact}}
            {{/each}}
          </tbody>
          <tfoot class="full-width">
            <tr>
              <th colspan="3">
                <!-- TODO: fix button -->
                <div class="ui right floated small labeled button task-add-button">
                  Add Task
                </div>
              </th>
            </tr>
          </tfoot>
        </table>
      </div> <!-- tabs 1 -->
      <div class="ui bottom attached tab segment" data-tab="second">
        Second
      </div>
      <div class="ui bottom attached tab segment" data-tab="third">
        Third
      </div>
    </div>

  </div>
</template>

<template name="projectComments">
  <p class="root-comment-toggle">
    Click here to leave a comment.
  </p>
  <form class="ui form root-comment-form">
    <div class="ui tiny action input">
      <input class="fluid root-comment-text" type="text">
      <button class="ui icon button root-comment-button">
        <i class="chevron right icon"></i>
      </button>
    </div>
  </form>

  <div class="ui comments no-padding-bottom">
    {{#each comments}}
      <div class="ui divider"></div>
      {{> projectCommentsRow}}
    {{/each}}
  </div>
</template>

<template name="projectCommentsRow">
  <div class="comment" style="background-color: {{debugColor userId 'light'}};">
    <div class="content">
      <a class="author {{#if isUserComment}}text-self{{/if}}" href="/users/{{userId}}">{{profile.name}}</a>
      <div class="metadata">
        <span class="date">{{aLongLongTimeAgo}}</span>
      </div>
      <div class="text {{#if isRemoved}}text-removed{{/if}}">
        {{comment}}
        {{#if ghostComment}}<div class="text-removed-ghost">{{removedComment}}</div>{{/if}}
      </div>
      <a class="text-action comment-reply">Reply</a>
      {{#if showRemove}}<a class="text-action comment-remove">Remove</a>{{/if}}
      {{#if isAdmin true false}}<a class="text-action comment-delete">Delete</a>{{/if}}
    </div> <!-- content -->

    <form class="ui form comment-container" style="display: none;">
      <div class="ui tiny action input">
        <input class="comment-text" type="text">
        <!-- <button class="ui tiny button comment-button">Comment</button> -->
        <button class="ui icon button comment-button">
          <i class="chevron right icon"></i>
        </button>
      </div>
    </form>

      {{#if hasReplies}}
        <div class="ui comments no-padding-bottom">
          {{#each replies}}
            {{> projectCommentsRow}}
          {{/each}}
        </div>
      {{/if}}
  </div> <!-- comment -->
</template>

<template name="taskDetailCompact">
  <tr>
    <td>
      <a class="task" href="/tasks/{{_id}}">{{title}}</a>
    </td>
    <td>
      <a class="user" href="/users/{{createdId}}">{{assignedTo}}</a>
    </td>
    <td class="collapsing">{{dueDateString}}</td>
  </tr>
</template>

<template name="progress">
  <div class="ui fluid tiny steps">
    <div class="completed step">
      <div class="content">
        <div class="title">Project Request</div>
        <div class="description">Completed: 03/14/2017</div>
      </div>
    </div>
    <div class="completed step">
      <div class="content">
        <div class="title">Requirements</div>
        <div class="description">Completed: 05/17/2017</div>
      </div>
    </div>
    <div class="active step">
      <div class="content">
        <div class="title">Development</div>
        <div class="description">Started on: 05/18/2017</div>
      </div>
    </div>
    <div class="step">
      <div class="content">
        <div class="title">Testing</div>
        <div class="description">Planned Start: 06/30/2017</div>
      </div>
    </div>
    <div class="step">
      <div class="content">
        <div class="title">UAT</div>
        <div class="description">Planned Start: 08/07/2017</div>
      </div>
    </div>
  </div>
</template>

<template name="verticalProjectMenu">
  <div class="ui vertical menu">
    <div class="item">
      <div class="header">Information</div>
      <div class="menu">
        <a class="item">View Tasks</a>
        <a class="item">View Assignments</a>
        <a class="item">View Resources</a>
        <a class="item">View Stats</a>
      </div>
    </div>
    {{#if isInRole "admin,project-mgr"}}
    <div class="item">
      <div class="header">Project Management</div>
      <div class="menu">
        <a class="item">Edit Project</a>
        <a class="item">Edit Assignments</a>
        <a class="item">Post Announcement</a>
      </div>
    </div>
    {{/if}}
    {{#if isInRole "admin"}}
      <div class="item">
        <div class="header">Admin</div>
        <div class="menu">
          <a class="item">Ghost Project</a>
        </div>
      </div>
    {{/if}}
  </div>
</template>
